# Проектная работа "Веб-ларек"

Реализация интернет-магазина с товарами для веб-разработчиков — Web-ларёк. В нём можно посмотреть каталог товаров, добавить товары в корзину и сделать заказ.

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## UML-диаграмма классов и интерфейсов

![UML-диаграмма классов и интерфейсов](src/images/uml-web-larek.drawio.png)

## Об архитектуре

Архитектура проекта строится на паттерне MVP (Model-View-Presenter). Модели (Model) управляют данными и бизнес-логикой, представления (View) отображают информацию для пользователя. В качестве Presenter выступает код, прописанный в index.ts, который реализует бизнес-логику и управляет взаимодействием между моделями и представлениями.

Взаимодействия внутри приложения происходят через события. Модели инициализируют события, слушатели событий в основном коде выполняют передачу данных компонентам отображения, а также вычислениями между этой передачей, и еще они меняют значения в моделях.

## Описание данных

### Класс EventEmitter

Класс EventEmitter обеспечивает работу событий в приложении. Он предоставляет возможность установки и снятия слушателей событий, а также вызова слушателей при возникновении события.

### Компоненты и их методы

В архитектуре проекта выделяются следующие компоненты:

#### Form

Отображает форму для ввода данных.  
Методы: render(), onInputChange().  
Взаимодействует с компонентом Button.

#### Modal

Отображает модальное окно.  
Методы: open(), close(), render(data: IModalData).  
Взаимодействует с компонентами, переданными через данные (например, содержимым модального окна).

#### Basket

Отображает содержимое корзины.  
Методы: отображение элементов корзины, расчет общей стоимости.  
Взаимодействует с компонентами-элементами корзины и кнопкой.

#### Page

Отображает страницу приложения.  
Методы: управление каталогом, отображение счетчика, отображение корзины.  
Взаимодействует с компонентами каталога, корзины и счетчика.

#### Card

Отображает карточку товара.  
Методы: отображение информации о товаре.  
Взаимодействует с данными карточки товара.

#### API

Обеспечивает взаимодействие с сервером.  
Методы: отправка GET и POST запросов, обработка ответов.  
Взаимодействует с сервером для получения и отправки данных.

### Взаимодействие компонентов

Компоненты формы (Form, PaymentForm, OrderForm, SuccessForm) взаимодействуют с кнопкой для отправки формы (компонент Button).  
Модальное окно (Modal) взаимодействует с другими компонентами, переданными через данные (например, содержимым модального окна).  
Компоненты страницы (Page) взаимодействуют с каталогом товаров, корзиной и счетчиком.  
Компонент корзины (Basket) взаимодействует с элементами корзины и кнопкой.  
Компонент карточки товара (Card) взаимодействует с данными карточки товара.

### Используемые данные

Для хранения данных используются следующие типы данных или интерфейсы:

ICard: описывает структуру карточки товара.  
IForm: описывает структуру формы с вводом данных.  
IModalData: описывает данные модального окна.  
IOrderResult: описывает результат заказа.  
IEvents: интерфейс для работы с событиями.  
IShopAPI: интерфейс для работы с API магазина.  
IAppState: интерфейс для хранения состояния приложения.

### Реализация процессов в приложении

Процессы в приложении реализуются через взаимодействие компонентов и использование событий. Например, при отправке формы происходит взаимодействие формы с кнопкой, которое инициирует отправку данных на сервер через API. Взаимодействие между компонентами происходит с использованием событий, что позволяет организовать отслеживание и обработку различных событий в приложении.

---

## Подробное описание классов и их методов

#### abstract Class Component\<T>

Этот абстрактный класс предоставляет базовые методы для работы с компонентами пользовательского интерфейса.

Конструктор:

constructor(container: HTMLElement)  
Принимает элемент контейнера, в который будет помещен компонент.

Методы:

toggleClass(): Позволяет переключить класс у указанного элемента.
setDisabled(): Устанавливает состояние "отключено" для указанного элемента.  
setHidden(): Скрывает указанный элемент.
setVisible(): Отображает указанный элемент.
setImage(): Устанавливает изображение с альтернативным текстом для указанного элемента.
render(): Отрисовывает компонент в контейнере, принимая опциональные данные для обновления.

##### Классы расширяющие Component:

#### Class Form\<T>

Предназначен для создания и управления формами. Он обеспечивает обработку событий ввода и отправки, а также управляет состоянием валидности и отображения формы. Наследуется от Component<IFormState>.

Конструктор:

constructor(container: HTMLFormElement, events: IEvents)  
Принимает контейнер формы и объект событий для обработки взаимодействия с формой.

Свойства:

\_submit: HTMLButtonElement - Кнопка отправки формы.  
\_errors: HTMLElement - Элемент для отображения ошибок формы.

Методы:

onInputChange() - для обработки изменения ввода.
render() - для отрисовки формы.

#### Class PaymentForm

Предназначен для создания и управления формой оплаты. Он расширяет функциональность базового класса Form<IForm>, добавляя дополнительные свойства, специфичные для формы оплаты.

Конструктор:

constructor(container: HTMLFormElement, events: IEvents)  
Принимает контейнер формы и объект событий для обработки взаимодействия с формой.

Свойства:

payMethod?: String - Способ оплаты.  
address?: String - Адрес.

#### Class OrderForm

Предназначен для создания и управления формой оформления заказа. Этот класс расширяет базовый функционал класса Form<IForm>, добавляя возможность ввода электронной почты и номера телефона пользователя для оформления заказа.

Конструктор:

constructor(container: HTMLFormElement, events: IEvents)  
Принимает контейнер формы и объект событий для обработки взаимодействия с формой.

Свойства:

email?: String - Электронная почта.  
phone?: String - Номер телефона.

#### Class SuccessForm

Предназначен для создания и управления формой успешного завершения действия. Этот класс расширяет базовый функционал класса Form<IForm>, добавляя возможность отображения изображения, заголовка и описания, сообщающих о успешном завершении действия.

Конструктор:

constructor(container: HTMLFormElement, events: IEvents)  
Принимает контейнер формы и объект событий для обработки взаимодействия с формой.

Свойства:

image?: String: Изображение.  
title?: String: Заголовок.  
description?: String: Описание.

#### abstract Class Model\<T>

Предназначен для работы с моделями данных. Этот абстрактный класс предоставляет базовый функционал для управления данными и генерации событий об изменениях.

Конструктор:

constructor(data: Partial<T>, events: IEvents)  
Принимает частичные данные модели и объект событий для обработки изменений.

Методы:

emitChanges(): Генерирует событие об изменениях модели.

#### Class AppState

Предназначен для работы с состоянием приложения. Этот класс расширяет функциональность базового класса Model<IAppState>, добавляя дополнительные свойства и методы, специфичные для управления состоянием приложения.

Свойства:

catalog: ICard[]: Каталог товаров.  
basket: string[]: Корзина.  
order: IForm: Заказ.

Методы:
clearBasket(): Очищает корзину.  
getTotal(): Возвращает общую сумму заказа.  
setCatalog(items: ICard[]): Устанавливает список элементов каталога.

### Описание интерфейсов

#### Interface IForm

Интерфейс, описывающий структуру формы.

payMethod?: String: Способ оплаты.  
address?: String: Адрес.  
email?: String: Электронная почта.  
phone?: String: Номер телефона.  
image?: String: Изображение.  
title?: String: Заголовок.  
description?: String: Описание.

#### Interface IModalData

Интерфейс, описывающий данные модального окна.

content: HTMLElement: Содержимое модального окна.

#### Interface IBasket

Интерфейс, описывающий структуру корзины.

items: HTMLElement[]: Элементы корзины.  
totalPrice: String: Общая стоимость.  
button: HTMLButtonElement: Кнопка корзины.

#### Interface IPage

Интерфейс, описывающий структуру страницы.

counter: number: Счётчик.  
catalog: HTMLElement[]: Элементы каталога.

#### Interface ICard

Интерфейс, описывающий структуру карточки.

id: String: Идентификатор карточки.  
description?: String: Описание карточки.  
image?: String: Изображение карточки.  
title: String: Заголовок карточки.  
category?: String: Категория карточки.  
price: Number: Цена карточки.

#### Interface IAppState

Интерфейс, описывающий структуру состояния приложения.

catalog: ICard[]: Список карточек товаров.  
basket: string[]: Список товаров в корзине.  
order: IForm: Информация о заказе.

#### Type Category

Тип данных, описывающий категории.

### Базовые классы

#### Class EventEmitter

Базовый класс, предоставляющий функциональность для работы с событиями.

Конструктор:

```ts
constructor() {
    this._events = new Map<EventName, Set<Subscriber>>();
}
```

Создает новый экземпляр класса EventEmitter. Инициализирует внутреннюю структуру данных для хранения событий и их обработчиков.

Свойства:

\_events: Хранит события и их обработчики.

Методы:

on() - Метод для подписки на событие.  
off() - Метод для отписки от события.  
emit() - Метод для генерации события.  
onAll() - Метод для подписки на все события.  
offAll() - Метод для отписки от всех событий.  
trigger() - Метод для выполнения события.

#### Class Api

Класс для работы с API.

Конструктор:

```ts
constructor(baseUrl: string, options: RequestInit = {}) {
    this.baseUrl = baseUrl;
    this.options = {
        headers: {
            'Content-Type': 'application/json',
            ...(options.headers as object ?? {})
        }
    };
}
```

Создает новый экземпляр класса Api с заданным базовым URL и опциями запроса.

Свойства:

baseUrl - String: Базовый URL.  
options: RequestInit - Опции запроса.

Методы:

handleResponse() - Метод для обработки ответа.  
get() - Метод для выполнения GET-запроса.  
post() - Метод для выполнения POST-запроса.

#### Class ShopAPI

Класс для работы с API магазина, расширяющий базовый класс Api.

Конструктор:

```ts
constructor(cdn: string, baseUrl: string, options?: RequestInit) {
    super(baseUrl, options);
    this.cdn = cdn;
}
```

Создает новый экземпляр класса ShopAPI с заданным URL для CDN, базовым URL и опциями запроса.

Свойства:

cdn: String: URL для CDN.

### Интерфейсы

#### Interface IEvents

Интерфейс для работы с событиями.

on(): void: Метод для подписки на событие.  
emit(): void: Метод для генерации события.  
trigger(): () => void: Метод для выполнения события.

#### Interface IShopAPI

Интерфейс для работы с API магазина.

getCardList: () => Promise\<ICard[]>: Метод для получения списка карточек.  
getCardItem: () => Promise\<ICard>: Метод для получения карточки.  
orderCards: () => Promise\<IOrderResult>: Метод для заказа карточек.

#### Interface IOrderResult

Интерфейс для хранения результата заказа.

id: String: Идентификатор заказа.
